内存模型
	线程共享区
		堆空间
			生命周期
				生命周期与JVM生命周期一致
			异常
				OutOfMemoryError
			分代
				新生代
					伊甸园（Eden space）
					幸存0区（Survivor）
					幸存1区
				老年代
			JVM参数
				初始大小
					Xms
				最大空间
					Xmx
		方法区
			概念
				分代
					永久代
						配置参数
							-XX:MaxPermSize
							-XX:PermSize
				异常
					OutOfMemoryError
				运行时常量池
					String.intern()
						将字符串增加到常量池中
							已存在
							不存在
					new出来的字符串，不会放在常量池中
			存储信息
				类信息
				常量
				静态变量
				即时编译器编译后的代码
	线程私有区
		程序计数器
			异常
				此内存区域是唯一一个在Java虚拟机规范中
没有任何OutOfMemoryError情况的区域
		虚拟机栈
			概念
				异常
					StackOverFlowError
					OutOfMemoryError
			存储信息(针栈)
				针栈
					局部变量表
					操作数栈
						字节码指令，先入后出
						调用其它方法的时候是通过操作数栈来传递参数的
					动态链接
					方法出口（方法返回地址）
						概述
							方法退出的过程实际上就等等与把当前栈帧出栈，退出可能执行的操作
						退出种类
							正常完成出口
								执行引擎遇到任意一个方法返回的字节码指令
							异常完成出口
								方法执行过程中遇到了异常，并且这个异常没有在方法体内得到处理
					额外附加信息
		本地方法栈
			异常
				StackOverflowError
				OutOfMemoryError
	直接内存
		异常
			OutOfMemoryError
内存管理
	Java对象
		对象创建流程
			第一步
				检查常量池
				检查类加载、解析、初始化
					是
						/
					否
						那必须先执行相应的类加载过程，
				指针策略
					CAS
					TLAB
				空间分配
					指针碰撞
						Serial
						Compact
					空闲列表
						CMS
							基于Mark-Sweep算法
						分配内存的指针安全性
							指针并非是安全的
				初始化内存空间为零值
				设置对象属性
				完成对象创建
			第二步
				设置对象信息
				初始化类信息
		对象内存布局
			对象头（Header）
				自身信息（Mark Word）
					哈希码（HashCode）
					GC分代年龄
					锁状态标志
					线程持有的锁
					偏向线程ID
					偏向时间戳
				类型指针
					指向它的类元数据的指针
			实例数据（Instance Data）
			对齐填充（Padding）
		对象的访问定位
			方式
				句柄
				直接指针
			区别
	异常
		OutOfMemoryError
			Java堆
				-Xms
				-Xmx
			虚拟机栈和方法栈
				参数
					-Xss
				单线程
					实际一般抛出的异常都是StackOverflowError
				多线程
					StackOverflowError
					OutOfMemoryError
			方法区和运行时常量池
				参数
					参照永久区
			本机直接内存
				-XX: MaxDirectMemorySize
				特点
	垃圾收集器
		哪些内存需要回收？
		什么时候回收？
			分析
				计数器算法
					很多Java虚拟机并没有采用这方式
				可达性分析
					GC Roots
						虚拟机栈(栈帧中的本地变量表)中引用的对象
						方法区中类静态属性引用的对象
						方法区中常量引用的对象
						本地方法栈中JNI引用的对象
						额外
							引用
								强引用
								软引用
								弱引用
								虚引用
			判断
				第一次标记
					是否有必要执行finalize()方法
				第二次标记
		如何回收？
			回收堆空间
			回收方法区
				废弃常量
				无用的类
					    回收条件
（不一定回收）
						该类所有的实例都已经被回收，也就是Java堆中不存在该类的任何实例
						加载该类的ClassLoader已经被回收
						该类对应的java.lang.Class对象 没有在任何地方被引用，无法在任何地方通过反射访问该类的方法
					回收
	中断方式
		抢先式中断
		主动是终端
	垃圾收集算法
		常见算法
			标记-清除（Mark-Sweep）
			复制算法
				用于新生代
				特点
			标记-整理
				用于老年代
			分代收集
				一般用于商业虚拟机
		常见垃圾收集器
			G1收集器
			Serial收集器
				最早的收集器，单线程收集器
				GC的时候会暂停所有用户线程
			ParNew收集器
				开启
					默认
						-XX:+UseConcMarkSweepGC 
					强制
			ParallelScavenge收集器
				新生代收集器
				特点:关注吞吐量
					-XX:MaxGCPauseMillis
						收集最大吞吐停顿时间，接受一个大于0的ms数
					-XX:GCTimeRatio
						设置最大吞吐量，接受一个大于0小于100的整数
			Serial Old收集器
				ParallelScavenge收集器的老年代版本
			CMS(Concurrent Mark Sweep)收集器
				工作流程
					初识标记
					并发标记
					重新标记
					并发清除
		GC常见参数
	分配与回收
		分配
			对象优先在Eden分配
			大对象直接进入老年代
			长期存活的对象将进入老年代
	JDK工具
		JPS
			主要用来查询jvm的pid
			常用选项：-v
		jstat
			常用参数-class
			结果解读
				Jstat.pdf
		jinfo
			实时调整和查看虚拟机参数
		jmap
			用于生成堆栈快照
				获取虚拟机堆栈快照
					-XX:+HeapDumpOnOutOfMemoryError
						可以让虚拟机在OOM异常出现后自动生成dump文件
					-XX:+HeapDumpOnCtrlBreak
						此参数可以使Ctrl+Break键让虚拟机生成dump文件
					Kill -3
						Linux系统下通过此命令可以发送进程退出信号，虚拟机也会生成dump文件
			可以查询finalize执行队列
			Java堆和永久代的详细信息
		jhat
			虚拟机堆转储快照分析工具
		jstack
			Java堆栈跟踪工具，用于生成虚拟机当前时刻的虚拟机快照